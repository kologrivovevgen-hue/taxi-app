<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; margin: 0; padding: 10px; }
        .card { background: white; border-radius: 25px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.1); max-width: 420px; margin: auto; }
        .header { height: 160px; background: url('https://img.freepik.com/free-photo/white-sedan-car-driving-on-the-road-at-night_114579-5066.jpg') center/cover; position: relative; }
        .header-text { position: absolute; bottom: 15px; left: 20px; color: white; font-size: 22px; font-weight: 900; text-shadow: 0 2px 4px rgba(0,0,0,0.5); }
        .content { padding: 20px; }
        .lbl { font-size: 11px; font-weight: 800; margin-top: 15px; text-transform: uppercase; }
        .from-lbl { color: #e91e63; }
        .to-lbl { color: #4caf50; }
        select, input { width: 100%; padding: 12px; margin-top: 5px; border-radius: 12px; border: 2px solid #f0f0f0; font-size: 16px; font-weight: bold; outline: none; }
        .c-kedr { color: #1e88e5; } .c-ost { color: #8e24aa; } .c-pud { color: #43a047; } 
        .c-lush { color: #fb8c00; } .c-kal { color: #e53935; } .c-kul { color: #5d4037; }
        
        /* Ğ¡Ñ‚Ğ¸Ğ»Ğ¸ Ğ´Ğ»Ñ Ğ´Ğ¾Ğ¿. Ğ¾Ğ¿Ñ†Ğ¸Ğ¹ */
        .option-row { display: flex; align-items: center; justify-content: space-between; background: #f9f9f9; padding: 10px; border-radius: 12px; margin-top: 10px; border: 1px solid #eee; }
        .option-label { font-size: 14px; font-weight: bold; color: #555; }
        .check-box { width: 24px; height: 24px; cursor: pointer; }
        .stop-select { width: 60px; padding: 5px; margin: 0; }

        .price-box { background: linear-gradient(135deg, #2196f3, #00bcd4); color: white; padding: 15px; border-radius: 15px; text-align: center; margin-top: 20px; font-size: 28px; font-weight: 900; }
        .btn { background: #ff9800; color: white; border: none; width: 100%; padding: 18px; border-radius: 15px; font-size: 18px; font-weight: bold; margin-top: 15px; cursor: pointer; }
        .dev { text-align: center; margin-top: 20px; font-size: 10px; color: #aaa; }
    </style>
</head>
<body>
    <div class="card">
        <div class="header"><div class="header-text">ğŸš• ĞŸĞĞŸĞ£Ğ¢Ğ§Ğ˜Ğš 2026</div></div>
        <div class="content">
            <div class="lbl from-lbl">ğŸ“ ĞĞ¢ĞšĞ£Ğ”Ğ ĞŸĞ Ğ˜Ğ•Ğ¥ĞĞ¢Ğ¬:</div>
            <select id="f" onchange="calc()">
                <option class="c-kedr">ğŸŒ² ĞšĞ•Ğ”Ğ ĞĞ’Ğ«Ğ™</option><option class="c-ost">ğŸ˜ï¸ ĞĞ¡Ğ¢ĞĞĞ˜ĞĞ</option><option class="c-pud">ğŸ¡ ĞŸĞ£Ğ”Ğ˜ĞĞ</option><option class="c-lush">ğŸŒ¾ Ğ›Ğ£Ğ¨ĞĞ˜ĞšĞĞ’Ğ</option><option class="c-kul">ğŸ—ï¸ ĞšĞ£Ğ›ĞĞ¦ĞšĞ˜Ğ™</option><option class="c-kal">ğŸ  ĞšĞĞ›Ğ˜ĞĞ˜ĞĞ¡Ğš</option><option class="c-kedr">âœˆï¸ ĞĞ­Ğ ĞĞŸĞĞ Ğ¢</option><option class="c-lush">ğŸ Ğ”ĞĞ§Ğ˜</option>
            </select>
            
            <div class="lbl to-lbl">ğŸ ĞšĞ£Ğ”Ğ Ğ•Ğ”Ğ•Ğœ:</div>
            <select id="t" onchange="calc()">
                <option class="c-ost">ğŸ˜ï¸ ĞĞ¡Ğ¢ĞĞĞ˜ĞĞ</option><option class="c-kedr">ğŸŒ² ĞšĞ•Ğ”Ğ ĞĞ’Ğ«Ğ™</option><option class="c-pud">ğŸ¡ ĞŸĞ£Ğ”Ğ˜ĞĞ</option><option class="c-lush">ğŸŒ¾ Ğ›Ğ£Ğ¨ĞĞ˜ĞšĞĞ’Ğ</option><option class="c-kul">ğŸ—ï¸ ĞšĞ£Ğ›ĞĞ¦ĞšĞ˜Ğ™</option><option class="c-kal">ğŸ  ĞšĞĞ›Ğ˜ĞĞ˜ĞĞ¡Ğš</option><option class="c-kedr">âœˆï¸ ĞĞ­Ğ ĞĞŸĞĞ Ğ¢</option><option class="c-lush">ğŸ Ğ”ĞĞ§Ğ˜</option>
            </select>
            
            <div style="display:flex; gap:10px; margin-top:10px;">
                <div style="flex:1.2"><label class="lbl">ğŸ“… Ğ”ĞĞ¢Ğ</label><select id="ds" onchange="calc()"></select></div>
                <div style="flex:0.8"><label class="lbl">â° Ğ’Ğ Ğ•ĞœĞ¯</label><input type="time" id="tm" value="12:00" onchange="calc()"></div>
            </div>

            <div class="lbl" style="color:#607d8b">â• Ğ”ĞĞŸĞĞ›ĞĞ˜Ğ¢Ğ•Ğ›Ğ¬ĞĞ:</div>
            <div class="option-row">
                <span class="option-label">ğŸ“¦ Ğ“Ñ€ÑƒĞ· / Ğ‘Ğ°Ğ³Ğ°Ğ¶ (+50Ñ€)</span>
                <input type="checkbox" id="cargo" class="check-box" onchange="calc()">
            </div>
            <div class="option-row">
                <span class="option-label">ğŸ›‘ ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ (+50Ñ€ ĞºĞ°Ğ¶Ğ´Ğ°Ñ)</span>
                <select id="stops" class="stop-select" onchange="calc()">
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                </select>
            </div>

            <div class="price-box" id="pr">300Ñ€</div>
            <button class="btn" onclick="send()">ĞŸĞĞ”Ğ¢Ğ’Ğ•Ğ Ğ”Ğ˜Ğ¢Ğ¬</button>
            <div class="dev">Ğ ĞĞ—Ğ ĞĞ‘ĞĞ¢ĞšĞ:<br><b>ĞšĞĞ›ĞĞ“Ğ Ğ˜Ğ’ĞĞ’ Ğ•Ğ’Ğ“Ğ•ĞĞ˜Ğ™ Ğ•Ğ’Ğ“Ğ•ĞĞ¬Ğ•Ğ’Ğ˜Ğ§ Ğ˜ GEMINI</b></div>
        </div>
    </div>
    <script>
    let tg = window.Telegram.WebApp; 
    tg.expand();

    const P = {
        "ğŸŒ² ĞšĞ•Ğ”Ğ ĞĞ’Ğ«Ğ™-ğŸ˜ï¸ ĞĞ¡Ğ¢ĞĞĞ˜ĞĞ": 300, "ğŸ˜ï¸ ĞĞ¡Ğ¢ĞĞĞ˜ĞĞ-ğŸŒ² ĞšĞ•Ğ”Ğ ĞĞ’Ğ«Ğ™": 300,
        "ğŸŒ² ĞšĞ•Ğ”Ğ ĞĞ’Ğ«Ğ™-ğŸ¡ ĞŸĞ£Ğ”Ğ˜ĞĞ": 350, "ğŸ¡ ĞŸĞ£Ğ”Ğ˜ĞĞ-ğŸŒ² ĞšĞ•Ğ”Ğ ĞĞ’Ğ«Ğ™": 350,
        "ğŸŒ² ĞšĞ•Ğ”Ğ ĞĞ’Ğ«Ğ™-ğŸŒ¾ Ğ›Ğ£Ğ¨ĞĞ˜ĞšĞĞ’Ğ": 400, "ğŸŒ¾ Ğ›Ğ£Ğ¨ĞĞ˜ĞšĞĞ’Ğ-ğŸŒ² ĞšĞ•Ğ”Ğ ĞĞ’Ğ«Ğ™": 400,
        "ğŸŒ² ĞšĞ•Ğ”Ğ ĞĞ’Ğ«Ğ™-ğŸ—ï¸ ĞšĞ£Ğ›ĞĞ¦ĞšĞ˜Ğ™": 450, "ğŸ—ï¸ ĞšĞ£Ğ›ĞĞ¦ĞšĞ˜Ğ™-ğŸŒ² ĞšĞ•Ğ”Ğ ĞĞ’Ğ«Ğ™": 450,
        "ğŸŒ² ĞšĞ•Ğ”Ğ ĞĞ’Ğ«Ğ™-ğŸ  ĞšĞĞ›Ğ˜ĞĞ˜ĞĞ¡Ğš": 500, "ğŸ  ĞšĞĞ›Ğ˜ĞĞ˜ĞĞ¡Ğš-ğŸŒ² ĞšĞ•Ğ”Ğ ĞĞ’Ğ«Ğ™": 500,
        "ğŸŒ² ĞšĞ•Ğ”Ğ ĞĞ’Ğ«Ğ™-ğŸŒ² ĞšĞ•Ğ”Ğ ĞĞ’Ğ«Ğ™": 200, "ğŸŒ² ĞšĞ•Ğ”Ğ ĞĞ’Ğ«Ğ™-âœˆï¸ ĞĞ­Ğ ĞĞŸĞĞ Ğ¢": 400,
        "âœˆï¸ ĞĞ­Ğ ĞĞŸĞĞ Ğ¢-ğŸŒ² ĞšĞ•Ğ”Ğ ĞĞ’Ğ«Ğ™": 400, "ğŸŒ² ĞšĞ•Ğ”Ğ ĞĞ’Ğ«Ğ™-ğŸ Ğ”ĞĞ§Ğ˜": 400,
        "ğŸ Ğ”ĞĞ§Ğ˜-ğŸŒ² ĞšĞ•Ğ”Ğ ĞĞ’Ğ«Ğ™": 400, "ğŸ¡ ĞŸĞ£Ğ”Ğ˜ĞĞ-ğŸŒ¾ Ğ›Ğ£Ğ¨ĞĞ˜ĞšĞĞ’Ğ": 300,
        "ğŸŒ¾ Ğ›Ğ£Ğ¨ĞĞ˜ĞšĞĞ’Ğ-ğŸ¡ ĞŸĞ£Ğ”Ğ˜ĞĞ": 300, "ğŸ¡ ĞŸĞ£Ğ”Ğ˜ĞĞ-ğŸ  ĞšĞĞ›Ğ˜ĞĞ˜ĞĞ¡Ğš": 400, "ğŸ  ĞšĞĞ›Ğ˜ĞĞ˜ĞĞ¡Ğš-ğŸ¡ ĞŸĞ£Ğ”Ğ˜ĞĞ": 400
    };

    function fill() {
        const s = document.getElementById('ds');
        const now = new Date();
        for(let i=0; i<3; i++) {
            let d = new Date(); 
            d.setDate(now.getDate() + i);
            let label = (i===0?"Ğ¡ĞµĞ³Ğ¾Ğ´Ğ½Ñ ":(i===1?"Ğ—Ğ°Ğ²Ñ‚Ñ€Ğ° ":"")) + d.toLocaleDateString('ru-RU',{month:'short',day:'numeric'});
            // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ Ğ´Ğ°Ñ‚Ñƒ Ğ² Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğµ YYYY-MM-DD Ğ´Ğ»Ñ Ğ»ĞµĞ³ĞºĞ¾Ğ³Ğ¾ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ
            let val = d.toISOString().split('T')[0];
            s.add(new Option(label, val));
        }
        // Ğ£ÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ñ‚ĞµĞºÑƒÑ‰ĞµĞµ Ğ²Ñ€ĞµĞ¼Ñ Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ
        let hours = String(now.getHours()).padStart(2, '0');
        let minutes = String(now.getMinutes()).padStart(2, '0');
        document.getElementById('tm').value = hours + ":" + minutes;
    }

    function calc() {
        const dateSel = document.getElementById('ds');
        const timeInput = document.getElementById('tm');
        const now = new Date();
        
        // --- Ğ‘Ğ›ĞĞšĞ˜Ğ ĞĞ’ĞšĞ ĞŸĞ ĞĞ¨Ğ•Ğ”Ğ¨Ğ•Ğ“Ğ Ğ’Ğ Ğ•ĞœĞ•ĞĞ˜ ---
        let selectedDate = dateSel.value;
        let todayStr = now.toISOString().split('T')[0];
        
        if (selectedDate === todayStr) {
            let currentTime = String(now.getHours()).padStart(2, '0') + ":" + String(now.getMinutes()).padStart(2, '0');
            if (timeInput.value < currentTime) {
                timeInput.value = currentTime; // Ğ¡Ğ±Ñ€Ğ°ÑÑ‹Ğ²Ğ°ĞµĞ¼ Ğ½Ğ° Ñ‚ĞµĞºÑƒÑ‰ĞµĞµ, ĞµÑĞ»Ğ¸ Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ»Ğ¸ Ğ¿Ñ€Ğ¾ÑˆĞ»Ğ¾Ğµ
            }
            timeInput.min = currentTime; // Ğ¡Ñ‚Ğ°Ğ²Ğ¸Ğ¼ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğµ Ğ² Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğµ
        } else {
            timeInput.min = "00:00"; // Ğ”Ğ»Ñ Ğ±ÑƒĞ´ÑƒÑ‰Ğ¸Ñ… Ğ´Ğ°Ñ‚ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğ¹ Ğ½ĞµÑ‚
        }

        // --- Ğ ĞĞ¡Ğ§Ğ•Ğ¢ Ğ¦Ğ•ĞĞ« ---
        let f = document.getElementById('f').value, t = document.getElementById('t').value, tm = timeInput.value;
        let base = P[f+"-"+t] || 400;
        let h = parseInt(tm.split(':')[0]), m = parseInt(tm.split(':')[1]);
        
        // ĞĞ¾Ñ‡Ğ½Ğ¾Ğ¹ Ñ‚Ğ°Ñ€Ğ¸Ñ„ (22:00 - 08:08)
        let n = (h >= 22 || h < 8 || (h === 8 && m <= 8));
        if(n) base *= 2;

        // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ Ğ³Ñ€ÑƒĞ· Ğ¸ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸
        if(document.getElementById('cargo').checked) base += 50;
        let stopsCount = parseInt(document.getElementById('stops').value);
        base += (stopsCount * 50);

        document.getElementById('pr').innerText = base + "Ñ€" + (n ? " ğŸŒ™" : " â˜€ï¸");
    }

    function send() {
        let cargoText = document.getElementById('cargo').checked ? "Ğ”Ğ°" : "ĞĞµÑ‚";
        let stopsText = document.getElementById('stops').value;
        tg.sendData(JSON.stringify({
            from: document.getElementById('f').value, 
            to: document.getElementById('t').value,
            date: document.getElementById('ds').options[document.getElementById('ds').selectedIndex].text, 
            time: document.getElementById('tm').value,
            cargo: cargoText, 
            stops: stopsText,
            price: document.getElementById('pr').innerText
        }));
    }
    fill(); 
    calc();
</script>